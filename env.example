# ========================================
# ENVIRONMENT CONFIGURATION
# ========================================
# Set to 'development' for local testing or 'production' for VPS deployment
ENVIRONMENT=development
LOG_LEVEL=INFO

# ========================================
# DEPLOYMENT MODE
# ========================================
# Enable HTTPS/SSL and Nginx reverse proxy for production
# Note: To enable HTTPS/Nginx, you must use a profile:
#   docker compose --profile https up -d
# Or start it separately:
#   docker compose up -d nginx certbot
# Set to true if you want to enable it
ENABLE_HTTPS=false

# Enable pgAdmin for database management UI
# Note: To start pgAdmin, you must use a profile:
#   docker compose --profile pgadmin up -d
# Or start it separately:
#   docker compose up -d pgadmin
# Set to true if you want to enable it
ENABLE_PGADMIN=false

# ========================================
# DOMAIN & SSL CONFIGURATION (Production)
# ========================================
# Required when ENABLE_HTTPS=true
# Your domain or subdomain pointing to the VPS
DOMAIN=api.yourdomain.com
# Email for Let's Encrypt certificate notifications
LETSENCRYPT_EMAIL=your-email@example.com

# ========================================
# AIRTABLE CONFIGURATION
# ========================================
AIRTABLE_API_KEY=your_airtable_api_key_here
AIRTABLE_BASE_ID=your_airtable_base_id_here
AIRTABLE_BATCH_SIZE=10

# Airtable Table IDs (optional - only change if your Airtable schema is different)
# COMPANIES_TABLE_ID=tblMsZnCUfG783lWI
# CREDIT_RATINGS_TABLE_ID=tblRlxbOYMW8Rag7f
# INFOMERICS_SCRAPER_TABLE_ID=tbliVxZjw5Uzpfxc5
# CONTACTS_TABLE_ID=tbljbYRWsRBb85X5y

# ========================================
# ATTESTR API CONFIGURATION
# ========================================
ATTESTR_API_KEY=your_attestr_api_key_here
ATTESTR_API_URL=https://api.attestr.com/api/v2/public/leadx/mca-cin-contact
ATTESTR_MAX_CONTACTS=100

# ========================================
# BRIGHT DATA WEB UNLOCKER (Optional)
# ========================================
# Enable Bright Data to bypass anti-bot measures and avoid datacenter IP blocks
# Set to 'true' for VPS deployment, 'false' for local development with direct requests
USE_BRIGHT_DATA=false
# Get your API key from: https://brightdata.com/cp/setting/users
BRIGHT_DATA_API_KEY=your_bright_data_api_key_here
# Zone identifier from: https://brightdata.com/cp/zones
BRIGHT_DATA_ZONE=web_unlocker1
# Retry configuration
BRIGHT_DATA_MAX_RETRIES=3
BRIGHT_DATA_RETRY_BACKOFF=2

# ========================================
# API CONFIGURATION
# ========================================
API_KEY=your_api_key_here
API_HOST=0.0.0.0
API_PORT=8000

# Rate Limiting (requests per hour)
RATE_LIMIT_REQUESTS=50
RATE_LIMIT_PERIOD=3600

# CORS (comma-separated origins, or * for all)
CORS_ORIGINS=*

# Job Configuration
MAX_DATE_RANGE_DAYS=90
MAX_DATE_CHUNK_DAYS=30

# ========================================
# POSTGRESQL DATABASE
# ========================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=infomerics
POSTGRES_USER=infomerics_user
# PRODUCTION: Use a strong random password!
POSTGRES_PASSWORD=your_secure_password_here

# Note: PostgreSQL is NOT exposed outside Docker network for security
# Access via: docker compose exec postgres psql -U infomerics_user -d infomerics

# ========================================
# PGADMIN (Database Management UI)
# ========================================
# Only enabled when ENABLE_PGADMIN=true
# Access at http://localhost:5050 (local) or http://YOUR_IP:5050
PGADMIN_PORT=5050
PGADMIN_DEFAULT_EMAIL=admin@infomerics.com
PGADMIN_DEFAULT_PASSWORD=admin

# ========================================
# RABBITMQ (Message Broker)
# ========================================
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_MANAGEMENT_PORT=15672  # Management UI port (internal only)
RABBITMQ_VHOST=/  # Virtual host (default is '/')
# PRODUCTION: Change these from default 'guest' credentials!
RABBITMQ_USER=guest
RABBITMQ_PASSWORD=guest

# Note: RabbitMQ is NOT exposed outside Docker network for security
# Access management UI via: docker run --network tyke_infomerics-network curlimages/curl curl http://guest:guest@rabbitmq:15672

# ========================================
# REDIS (Result Backend)
# ========================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
# PRODUCTION: Set a strong password!
REDIS_PASSWORD=

# Note: Redis is NOT exposed outside Docker network for security
# Access via: docker compose exec redis redis-cli

# ========================================
# CELERY CONFIGURATION
# ========================================
USE_CELERY=true
USE_POSTGRES_DEDUPLICATION=true
CELERY_TASK_TRACK_STARTED=true
CELERY_TASK_TIME_LIMIT=3600
CELERY_TASK_SOFT_TIME_LIMIT=3000
CELERY_WORKER_PREFETCH_MULTIPLIER=4

# Worker Concurrency (child processes per worker instance)
# Adjust based on your server's CPU cores
CELERY_SCRAPER_CONCURRENCY=5
CELERY_EXTRACTOR_CONCURRENCY=3
CELERY_UPLOADER_CONCURRENCY=10
CELERY_GENERAL_CONCURRENCY=4

# Worker Scaling (number of worker instances per service)
# Increase for higher throughput (requires more resources)
CELERY_SCRAPER_REPLICAS=1
CELERY_EXTRACTOR_REPLICAS=1
CELERY_UPLOADER_REPLICAS=1
CELERY_GENERAL_REPLICAS=1

# ========================================
# FLOWER MONITORING DASHBOARD
# ========================================
# PRODUCTION: Set strong credentials for Flower dashboard access
FLOWER_USER=admin
FLOWER_PASSWORD=your_secure_password_here

# Note: Flower is NOT exposed directly for security
# Access via nginx: http://localhost/flower/ or https://yourdomain.com/flower/
# Or via docker: docker compose exec flower curl http://localhost:5555

# ========================================
# WHATSAPP SERVICE
# ========================================
# The WhatsApp service uses whatsapp-web.js to send messages via WhatsApp Web
# Messages are queued via RabbitMQ for reliable delivery
WHATSAPP_ENABLED=true
WHATSAPP_MESSAGE_QUEUE=whatsapp_messages
WHATSAPP_STATUS_QUEUE=whatsapp_status

# Note: WhatsApp service is NOT exposed outside Docker network
# Access for QR code via: docker compose logs whatsapp-service
